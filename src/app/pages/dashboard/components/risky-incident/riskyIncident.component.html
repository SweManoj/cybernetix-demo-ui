<div class="custom-container">
    <ng-container>
        <div class="risky-user-container">
            <div class="risky-user-header">
                <div class="row m-auto" style="background: #2C4255;">
                    <div class="col-md-2" style="text-align: center;background: #041421;">
                        <img class="profile-image rounded-circle" src='./../../../../../assets/images/incident.jpg'
                            style="width: 4rem;margin-top: 2rem;" />
                        <div class="user-info m-t-sm">
                            <span style="color:#D3D3D3;size:26px;font-weight: 600">{{incidentDetail.incident}}</span>
                            <p></p>
                        </div>
                    </div>

                    <div class="col-md-8 mt-1 d-flex initialPadding ml-2">
                        <div class="container row">
                            <div class="col-md-5 mr-3">
                                <div class="mt-2" style="min-height: 4.5rem;">
                                    <span class="captionTitle">Affected Entities</span>
                                    <p class="captionData">{{incidentDetail.affectedEntity}}
                                    </p>
                                </div>
                                <div class="mt-2">
                                    <span class="captionTitle">Last Updated On</span>
                                    <p class="captionData">{{incidentDetail.lastUpdatedOn}}
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-3 ml-3">
                                <div class="mt-2" style="min-height: 4.5rem;">
                                    <span class="captionTitle">Last Updated By</span>
                                    <p class="captionData">{{incidentDetail.lastUpdatedBy}}
                                    </p>
                                </div>
                                <div class="mt-2">
                                    <span class="captionTitle">Current Status</span>
                                    <p class="captionData">{{incidentDetail.currentStauts}}
                                    </p>
                                </div>
                            </div>
                            <div class="col-md-3 ml-4">
                                <div class="mt-2" style="min-height: 4.5rem;">
                                    <span class="captionTitle">Outcome</span>
                                    <br />
                                    <span
                                        [ngStyle]="outcomeStyle(incidentDetail.outcome)">{{incidentDetail.outcome}}</span>
                                </div>
                                <div class="mt-2">
                                    <span class="captionTitle">Remediation</span>
                                    <p class="captionData">{{incidentDetail.remediation}}</p>
                                </div>
                            </div>
                        </div>
                    </div>

                    <div class="col-md-2 incidentButton">
                        <button mat-raised-button color="primary" (click)="routeToIncident(incidentDetail.incident)">AI
                            Incident Created</button>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>

    <div class="container-fluid showActivity initialPadding">
        <div class="row pt-3 pb-3">
            <div class="col-sm" *ngFor="let activity of incidentDetail.incidentActivities">
                <div class="media">
                    <img class="align-self-center" src='../assets/images/{{activity.image}}' />
                    <div class="media-body pl-3">
                        <p class="value">{{activity.value}}</p>
                        <span class="title">{{activity.title}}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Dotted lines - TVDE23 -->
    <ng-container *ngIf="dottedThreatVectorViolations">
        <div class="risky-user-violations container-fluid initialPadding mt-3 mb-4"
            *ngFor="let threatVectorViolations of dottedThreatVectorViolations">
            <div class="risk-date-stamp">
                <span>{{threatVectorViolations.violationDate}}</span>
            </div>
            <div class="row initialPadding" *ngFor="let item of threatVectorViolations.violations">
                <div class="col-md-12 d-flex">
                    <div class="risk-time-stamp">
                        <span>{{item.generatedTimestamp}}</span>
                    </div>

                    <div class="risky-separator mt-1" [ngStyle]="seperatorStyle()">
                        <span class="risk-dot rounded-circle">&nbsp;</span>
                    </div>

                    <div class="violationTitle" [ngClass]="{'data-exfiltaration' : item.pv == 'PV 094'}">
                        <div class="row mt-1 mb-2 ml-3 mr-1">
                            <div class="col-sm-12">
                                <span class="pointerCursor" (click)="item.accord = !item.accord">
                                    &emsp;<i *ngIf="item.accord" class="fa fa-angle-up"></i> <i *ngIf="!item.accord"
                                        class="fa fa-angle-down"></i>
                                </span>
                                <span class="pointerCursor pvValue"
                                    (click)="item.accord = !item.accord">{{item.pv}}</span>
                                <span class="pointerCursor pvText" (click)="item.accord = !item.accord">
                                    {{item.ruleInfo.title}}</span>

                                <span class="risk-score mr-5">{{item.riskScore}}</span>

                                <button mat-raised-button color="primary" *ngIf="item.pv=='IN 011'" class="pull-right"
                                    style="padding: 0px 10px;max-height: 2rem;margin-top: 2px;">AI
                                    Incident Created</button>
                            </div>
                        </div>

                        <div class="row col-md-12 violationInfo " *ngIf="item.accord">
                            <div class="mt-3 d-flex mb-3">
                                <div class="col-md-3 riskAccordBorder">
                                    <dl>
                                        <dt><i class="fa fa-caret-right"></i>&nbsp;&nbsp;Description</dt>
                                        <dd class="mt-2"> {{item.description}}</dd>
                                    </dl>
                                </div>

                                <div class="col-5 col-sm-5 riskAccordBorder">
                                    <dl>
                                        <dt><i class="fa fa-caret-right"></i>&nbsp;&nbsp;Threat Categorisation</dt>
                                    </dl>

                                    <div class="ml-4">
                                        <div class="row mt-1 details"
                                            *ngFor="let threatCategory of item.threatCategories">
                                            <div class="col-md-5">
                                                {{threatCategory.title}}
                                            </div>
                                            <b>&nbsp;:&nbsp;</b>
                                            <div class="col-md-6" style="word-break: break-word;">
                                                {{threatCategory.value}}
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="col-4 col-sm-4">
                                    <dl>
                                        <dt><i class="fa fa-caret-right"></i>&nbsp;&nbsp;Additional Info</dt>
                                    </dl>
                                    <div class="ml-4">
                                        <div class="row mt-1 details" *ngFor="let dummyData of item.additionalInfo">
                                            <div class="col-md-6">
                                                {{dummyData.title}}
                                            </div>
                                            <b>&nbsp;:&nbsp;</b>
                                            <div class="col-md-5"
                                                style="word-break: break-word;padding-right: inherit;">
                                                {{dummyData.value}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </ng-container>

    <!-- Solid lines-->
    <div class="risky-user-violations container-fluid initialPadding mt-3 mb-4"
        *ngFor="let threatVectorViolations of threatVectorViolations">
        <div class="risk-date-stamp">
            <span>{{threatVectorViolations.violationDate}}</span>
        </div>
        <div class="row initialPadding" *ngFor="let item of threatVectorViolations.violations">
            <div class="col-md-12 d-flex">
                <div class="risk-time-stamp">
                    <span>{{item.generatedTimestamp}}</span>
                </div>

                <div class="risky-separator mt-1">
                    <span class="risk-dot rounded-circle">&nbsp;</span>
                </div>

                <div class="violationTitle" [ngClass]="{'dhcp' : item.ruleInfo.title === 'DHCP RENEWAL'}">
                    <div class="row mt-1 mb-2 ml-3 mr-1">
                        <div class="col-sm-12">
                            <span class="pointerCursor" (click)="item.accord = !item.accord">
                                &emsp;<i *ngIf="item.accord" class="fa fa-angle-up"></i> <i *ngIf="!item.accord"
                                    class="fa fa-angle-down"></i>
                            </span>
                            <span class="pointerCursor pvValue" (click)="item.accord = !item.accord"
                                [ngStyle]="infoStyleObject(item.pv)">{{item.pv}}</span>
                            <span class="pointerCursor pvText" (click)="item.accord = !item.accord">
                                {{item.ruleInfo.title}}</span>

                            <span class="risk-score mr-5">{{item.riskScore}}</span>

                            <button mat-raised-button color="primary" *ngIf="item.pv=='IN 011'" class="pull-right"
                                style="padding: 0px 10px;max-height: 2rem;margin-top: 2px;">AI
                                Incident Created</button>
                        </div>
                    </div>

                    <div class="row col-md-12 violationInfo " *ngIf="item.accord">
                        <div class="mt-3 d-flex mb-3">
                            <div class="col-md-3 riskAccordBorder">
                                <dl>
                                    <dt><i class="fa fa-caret-right"
                                            [ngClass]="{'greyText':item.pv =='INFO'}"></i>&nbsp;&nbsp;Description</dt>
                                    <dd class="mt-2" [ngClass]="{'whiteText':item.pv =='INFO'}"> {{item.description}}
                                    </dd>
                                </dl>

                                <dl *ngIf="item.pv=='INFO'">
                                    <dt><i class="fa fa-caret-right"
                                            [ngClass]="{'greyText':item.pv =='INFO'}"></i>&nbsp;&nbsp;MAC</dt>
                                    <dd class="mt-2" [ngClass]="{'whiteText':item.pv =='INFO'}"> 00:0a:95:9d:68:16
                                    </dd>
                                </dl>
                            </div>

                            <div class="col-5 col-sm-5 riskAccordBorder">
                                <dl *ngIf="item.pv !=='INFO'">
                                    <dt><i class="fa fa-caret-right"></i>&nbsp;&nbsp;Threat Categorisation</dt>
                                </dl>

                                <div class="ml-4">
                                    <div class="row mt-1 details" *ngFor="let threatCategory of item.threatCategories">
                                        <div class="col-md-5" [ngClass]="{'whiteText':item.pv =='INFO'}">
                                            {{threatCategory.title}}
                                        </div>
                                        <b>&nbsp;:&nbsp;</b>
                                        <div class="col-md-6" [ngClass]="{'whiteText':item.pv =='INFO'}"
                                            style="word-break: break-word;">
                                            {{threatCategory.value}}
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div class="col-4 col-sm-4">
                                <dl *ngIf="item.pv !=='INFO'">
                                    <dt><i class="fa fa-caret-right"></i>&nbsp;&nbsp;Additional Info</dt>
                                </dl>
                                <div class="ml-4">
                                    <div class="row mt-1 details" *ngFor="let dummyData of item.additionalInfo">
                                        <div class="col-md-6" [ngClass]="{'whiteText':item.pv =='INFO'}">
                                            {{dummyData.title}}
                                        </div>
                                        <b>&nbsp;:&nbsp;</b>
                                        <div class="col-md-5" [ngClass]="{'whiteText':item.pv =='INFO'}"
                                            style="word-break: break-word;padding-right: inherit;">
                                            {{dummyData.value}}
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

</div>
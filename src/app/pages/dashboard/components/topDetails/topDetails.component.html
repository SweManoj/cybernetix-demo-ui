<!-- Risky Entities -->
<div *ngIf="componentType === 'riskyUser'" class="header row">
    <div class="col-6 col-md-6 col-sm-6 heading">
        Top Risky Entities
    </div>
    <div class="col-md-4 pr-4">
        <p-dropdown [options]="assignee" placeholder="USER" optionLabel="name" dropdownIcon="pi pi-caret-down"
            (onChange)="SelectedRiskyType($event)"></p-dropdown>
    </div>
    <div class="col-2 col-md-2 col-sm-2 settings-icon">
        <!-- <a routerLink="/allRiskyUsers">{{'global.viewAll' | translate}}</a> -->
        <span class="ion ion-md-settings"></span>
    </div>
</div>
<div *ngIf="componentType === 'riskyUser'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let selectedRisky of selectedRiskies;let i=index;">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'0.9rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="selectedRisky.value"
                    [routerLink]="['/riskyUser', selectedRisky.value]">{{selectedRisky.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span [ngClass]="{'high': i<=2, 'medium':i==3, 'low':i==4}"> {{selectedRisky.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<!-- Top Threats -->
<div *ngIf="componentType === 'topThreats'" class="header">
    <div class="col-md-12">
        <span>{{'global.topThreats' | translate}}</span>
        <span class="float-right">Entities</span>
    </div>
    <!-- <div class="col-9 col-md-9 centerAlign">
        {{'global.topViolations' | translate}}
    </div>
    <div class="col-3 col-md-3 centerAlign high">
        <a href="#">{{'global.viewAll' | translate}}</a>
        <span class="">Entities</span>
    </div> -->
</div>
<div *ngIf="componentType === 'topThreats'" class="top-threats ">
    <ng-container *ngFor="let threat of threatsList">
        <div class="threat-item row">
            <div class="col-10 col-md-10 threat-details centerAlign">
                <a routerLink="/pages/details/threats">{{threat.title}}</a>
                <!--<span>{{threat.description}}</span>-->
            </div>
            <div class="col-2 col-md-2 risk-count centerAlign">
                <span>{{threat.count}}</span>
                <!-- <span class=" risk-type ">Entities</span> -->
            </div>
        </div>
    </ng-container>
</div>

<div *ngIf="componentType==='topViolations' " class="header">
    <div class="col-md-12">
        <span>{{'global.topViolations' | translate}}</span>
        <span class="float-right">Violations</span>
    </div>
    <!-- <div class="col-9 col-md-9 heading ">
        {{'global.topThreats' | translate}}
    </div>
    <div class="col-3 col-md-3 centerAlign high">
        <a href="# ">{{'global.viewAll' | translate}}</a>
        <span class="">Violations</span>
    </div> -->
</div>
<div *ngIf="componentType==='topViolations' " class="top-violations  mt-3">
    <ng-container *ngFor="let threat of violationsList ">
        <div class="threat-item row pt-1 pb-2 " *ngIf="threat._id ">
            <!--<div class="col-sm-3 col-md-3 time-details ">-->
            <!--<span class="duration ">{{threat.duration}}</span>-->
            <!--<span>{{threat.date}}</span>-->
            <!--<span>{{threat.time}}</span>-->
            <!--</div>-->
            <div class="col-9 col-md-9 centerAlign p-3">
                <a routerLink="/pages/details/violation ">{{threat._id}} </a>
                <!--<span>{{threat.description}}</span>-->
            </div>
            <div class="col-3 col-md-3 risk-count centerAlign" style="place-content: center;">
                <span>{{threat.count}}</span>
                <!-- <span class="risk-type ">Policy Violations</span> -->
            </div>
        </div>
    </ng-container>
</div>

<div *ngIf="componentType==='terminatedUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topTerminatedUsers' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'terminatedUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let terminatedUser of terminatedUsers">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="terminatedUser.value"
                    [routerLink]="['/riskyUser', terminatedUser.value]">{{terminatedUser.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{terminatedUser.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<div *ngIf="componentType==='orphanUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topOrphanUsers' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'orphanUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let orphanUser of orphanUsers">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="orphanUser.value" [routerLink]="['/riskyUser', orphanUser.value]">{{orphanUser.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{orphanUser.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<div *ngIf="componentType==='externalUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topExternalUsers' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'externalUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let externalUser of externalUsers">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="externalUser.value" [routerLink]="['/riskyUser', externalUser.value]">{{externalUser.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{externalUser.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<div *ngIf="componentType==='riskyCloud' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topRiskyCloud' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'riskyCloud'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let riskyCloudUser of riskyCloudUsers">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="riskyCloudUser.value"
                    [routerLink]="['/riskyUser', riskyCloudUser.value]">{{riskyCloudUser.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{riskyCloudUser.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<div *ngIf="componentType==='dormantUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topDormantUsers' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'dormantUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let dormantUser of dormantUsers">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="dormantUser.value" [routerLink]="['/riskyUser', dormantUser.value]">{{dormantUser.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{dormantUser.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<div *ngIf="componentType==='serviceAccount' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topServiceAcoount' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'serviceAccount'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let serviceAcnt of serviceAccount">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="serviceAcnt.value" [routerLink]="['/riskyUser', serviceAcnt.value]">{{serviceAcnt.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{serviceAcnt.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<div *ngIf="componentType==='watchlistedUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topWatchlistedUsers' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'watchlistedUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let watchlistedUser of watchlistedUsers">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="watchlistedUser.value"
                   [routerLink]="['/riskyUser', watchlistedUser.value]">{{watchlistedUser.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{watchlistedUser.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

<div *ngIf="componentType==='privilegedUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topPrivilegedUsers' | translate}}
    </div>
    <!-- <div class="col-3 col-md-3 settings-icon ">
        <span class="ion ion-md-settings "></span>
    </div> -->
</div>
<div *ngIf="componentType === 'privilegedUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let privilegedUser of privilegedUsers">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'1.3rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image img-round" src='./../../../../../assets/images/user.png' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a *ngIf="privilegedUser.value"
                   [routerLink]="['/riskyUser', privilegedUser.value]">{{privilegedUser.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span> {{privilegedUser.score}}</span>
            </div>
        </div>
    </ng-container>
    <!--<div class="text-right pull-right view-all-link">
            <a routerLink="/pages/details/riskyUser/all">View All</a>
        </div>-->
</div>

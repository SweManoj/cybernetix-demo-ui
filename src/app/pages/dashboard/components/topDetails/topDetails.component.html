<!-- Risky Entities -->
<div *ngIf="componentType === 'riskyEntities'" class="header row d-block">
    <span>Top Risky Entities</span>
    <span ngbDropdown placement="bottom-right" class="float-sm-right">
        <button class="btn btn-sm buttonBg" id="dropdownBasic1" ngbDropdownToggle>
            {{selectRiskyType}}
        </button>
        <div class="buttonBg actionDropDown" ngbDropdownMenu aria-labelledby="dropdownBasic1">
            <button ngbDropdownItem (click)="changeRiskyType('user')" class="buttonBg">USER</button>
            <button ngbDropdownItem (click)="changeRiskyType('ip address')" class="buttonBg">IP ADDRESS</button>
            <button ngbDropdownItem (click)="changeRiskyType('host')" class="buttonBg">HOST</button>
        </div>
    </span>
</div>
<div *ngIf="componentType === 'riskyEntities'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let selectedRisky of selectedRiskies;let i=index;">
        <div class="row user-item" [ngStyle]="{'padding': riskyTypeSelected=='user'?'0.8rem':'0.9rem'}">
            <div *ngIf="riskyTypeSelected=='user'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src="./../../../../../assets/images/users/service_user.jpeg" />
            </div>
            <div *ngIf="riskyTypeSelected=='ip address'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image" src='./../../../../../assets/images/dashboard_icons/Ip@2x.png' />
            </div>
            <div *ngIf="riskyTypeSelected=='host'" class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image" src='./../../../../../assets/images/dashboard_icons/hostname@2x.png' />
            </div>
            <div class="centerAlign col-md-8 wordWrap">
                <a *ngIf="selectedRisky.value" class="cursorPointer"
                    (click)="viewRiskyEntityDetails(selectedRisky.entityId)">{{selectedRisky.value}}</a>
                <!-- <a *ngIf="!user.userid" [routerLink]="['/riskyUser', selectedRisky.sourceAddress]">{{selectedRisky.sourceAddress}}</a> -->
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <p></p>
                <span [ngStyle]="{'color':getRiskScoreColor(selectedRisky.score)}">
                    {{selectedRisky.score}}</span>
            </div>
        </div>
    </ng-container>
</div>

<!-- Top Violations -->
<div *ngIf="componentType === 'topViolations'" class="header">
    <div class="col-md-12">
        <span>TOP VIOLATIONS</span>
        <span class="float-right">Entities</span>
    </div>
</div>
<div *ngIf="componentType === 'topViolations'" class="top-threats ">
    <ng-container *ngFor="let violation of violations">
        <div class="threat-item row">
            <div class="col-10 col-md-10 threat-details centerAlign">
                <span>{{violation.policyName}}</span>
            </div>
            <div class="col-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':'crimson'}">{{violation.noOfEntities}}</span>
            </div>
        </div>
    </ng-container>
</div>
<!-- Top Threats -->
<div *ngIf="componentType==='topThreats'" class="header">
    <div class="col-md-12">
        <span>TOP THREAT VECTORS</span>
        <span class="float-right">Violations</span>
    </div>
</div>
<div *ngIf="componentType ==='topThreats' " class="top-violations  mt-3">
    <ng-container *ngFor="let threat of threats">
        <div class="threat-item row pt-1 pb-2">
            <div class="col-9 col-md-9 centerAlign p-3">
                <span>{{threat.threatCategory}}</span>
            </div>
            <div class="col-3 col-md-3 risk-count centerAlign" style="place-content: center;">
                <span style="color: crimson;font-size:28px;">{{threat.riskCount}}</span>
            </div>
        </div>
    </ng-container>
</div>

<!-- Terminated Users -->
<div *ngIf="componentType==='terminatedUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        TOP TERMINATED USERS
    </div>
</div>
<div *ngIf="componentType === 'terminatedUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let terminatedUser of terminatedUsers">
        <div class="row user-item blockPadding">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src='./../../../../../assets/images/users/service_user.jpeg' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a [routerLink]="['/riskyUser', terminatedUser.entityId]" class="pointerCursor">{{terminatedUser.fName}}
                    {{terminatedUser.lName}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(terminatedUser.riskscorebygrp)}">
                    {{terminatedUser.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'terminatedUsers' && terminatedUsers.length === 0" class="no-user">
    No Terminated Users found
</div>

<!-- Orphan Users -->
<div *ngIf="componentType==='orphanUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        TOP ORPHAN USERS
    </div>
</div>
<div *ngIf="componentType === 'orphanUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let orphanUser of orphanUsers">
        <div [routerLink]="['/riskyUser',orphanUser.entityId]" class="row user-item blockPadding pointerCursor">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle" src='./../../../../../assets/images/users/orphan_user.png'
                    style="width: 2.9rem;height: 2.9rem;" />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a>{{orphanUser.entityId}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(orphanUser.riskscorebygrp)}">
                    {{orphanUser.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'orphanUsers' && orphanUsers.length === 0" class="no-user">
    No Orphan Users found
</div>

<!-- External Users -->
<div *ngIf="componentType==='externalUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        TOP EXTERNAL USERS
    </div>
</div>
<div *ngIf="componentType === 'externalUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let externalUser of externalUsers">
        <div class="row user-item blockPadding">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src='./../../../../../assets/images/users/service_user.jpeg' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a  [routerLink]="['/riskyUser', externalUser.entityId]" class="pointerCursor">{{externalUser.entityId}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(externalUser.riskscorebygrp)}">
                    {{externalUser.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'externalUsers' && externalUsers.length === 0" class="no-user">
    No External Users found
</div>

<!-- TOP CLOUD USERS -->
<div *ngIf="componentType==='riskyCloud' " class="header row">
    <div class="col-9 col-md-12 heading ">
        TOP OKTA USERS
    </div>
</div>
<div *ngIf="componentType === 'riskyCloud'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let riskyCloudUser of riskyCloudUsers">
        <div [routerLink]="['/riskyUser', riskyCloudUser.entityId]" class="row user-item blockPadding pointerCursor">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src='./../../../../../assets/images/users/service_user.jpeg' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a>{{riskyCloudUser.entityId}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(riskyCloudUser.riskscorebygrp)}">
                    {{riskyCloudUser.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'riskyCloud' && riskyCloudUsers.length === 0" class="no-user">
    No Cloud Users found
</div>

<!-- Dormant Users -->
<div *ngIf="componentType==='dormantUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        TOP DORMANT USERS
    </div>
</div>
<div *ngIf="componentType === 'dormantUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let dormantUser of dormantUsers">
        <div class="row user-item blockPadding">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src='../../../../../../assets/images/users/service_user.jpeg' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a [routerLink]="['/riskyUser', dormantUser.entityId]" class="pointerCursor">{{dormantUser.entityId}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(dormantUser.riskscorebygrp)}">
                    {{dormantUser.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'dormantUsers' && dormantUsers.length === 0" class="no-user">
    No Dormant Users found
</div>

<!-- Top Service Account -->
<div *ngIf="componentType==='serviceAccount' " class="header row">
    <div class="col-9 col-md-12 heading ">
        TOP SERVICE ACCOUNTS
    </div>
</div>
<div *ngIf="componentType === 'serviceAccount'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let serviceAcnt of serviceAccount">
        <div class="row user-item blockPadding">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src="./../../../../../assets/images/users/service_user.jpeg" />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a [routerLink]="['/riskyUser',  serviceAcnt.entityId]" class="pointerCursor">
                    {{serviceAcnt.entityId}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(serviceAcnt.riskscorebygrp)}">
                    {{serviceAcnt.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'serviceAccount' && serviceAccount.length === 0" class="no-user">
    No Service Account Users found
</div>

<!-- Watch list users-->
<div *ngIf="componentType==='watchlistedUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        TOP NEW USERS
    </div>
</div>
<div *ngIf="componentType === 'watchlistedUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let watchlistedUser of watchlistedUsers">
        <div class="row user-item blockPadding">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src='./../../../../../assets/images/users/service_user.jpeg' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a [routerLink]="['/riskyUser', watchlistedUser.entityId]" class="pointerCursor"> {{watchlistedUser.entityId}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(watchlistedUser.riskscorebygrp)}">
                    {{watchlistedUser.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'watchlistedUsers' && watchlistedUsers.length === 0" class="no-user">
    No Flight Users found
</div>

<!-- Privileged Users -->
<div *ngIf="componentType==='privilegedUsers' " class="header row">
    <div class="col-9 col-md-12 heading ">
        {{'global.topPrivilegedUsers' | translate}}
    </div>
</div>
<div *ngIf="componentType === 'privilegedUsers'" class="top-riksy-users mt-2">
    <ng-container *ngFor="let privilegedUser of privilegedUsers">
        <div  class="row user-item blockPadding">
            <div class="col-2 col-sm-2 col-md-2 pl-2">
                <img class="profile-image rounded-circle"
                    src='./../../../../../assets/images/users/service_user.jpeg' />
            </div>
            <div class="col-8 col-sm-8 col-md-8 centerAlign">
                <a [routerLink]="['/riskyUser', privilegedUser.entityId]" class="pointerCursor">{{privilegedUser.entityId}}</a>
            </div>
            <div class="col-2 col-sm-2 col-md-2 risk-count centerAlign">
                <span [ngStyle]="{'color':getRiskScoreColor(privilegedUser.riskscorebygrp)}">
                    {{privilegedUser.riskscorebygrp}}</span>
            </div>
        </div>
    </ng-container>
</div>
<div *ngIf="componentType === 'privilegedUsers' && privilegedUsers.length === 0" class="no-user">
    No Privileged Users found
</div>
